<script lang="ts">
	import DocsShell from '../../DocsShell/DocsShell.svelte';
	import { DocsFeature, type DocsShellSettings } from '../../DocsShell/types';
	import DocsPreview from '../../DocsPreview/DocsPreview.svelte';
	// Utilities
	import CodeBlock from '$lib/components/DataDisplay/CodeBlock/CodeBlock.svelte';
	// Components
	import InputChip from '$lib/components/Inputs/InputChip/InputChip.svelte';
	// Sveld
	import sveldInputChip from '$lib/components/Inputs/InputChip/InputChip.svelte?raw&sveld';

	// Docs Shell
	const settings: DocsShellSettings = {
		feature: DocsFeature.Component,
		name: 'Input Chip',
		description: 'Allows input of multiple values.',
		imports: ['InputChip'],
		stylesheetIncludes: ['all', 'elements'],
		stylesheets: ['elements/forms', 'elements/chips'],
		source: 'components/Inputs/InputChip',
		components: [{ sveld: sveldInputChip }],
		restProps: 'input'
	};

	// Local
	let anythingList: string[] = ['foo', 'bar', 'fizz', 'buzz'];
	let flavorsList = ['vanilla', 'chocolate', 'strawberry'];
	let flavorsWhitelist = ['vanilla', 'chocolate', 'strawberry', 'peach', 'rocky road'];
	let emails = ['john@email.com', 'jane@email.com', 'sally@email.com'];

	function isValidEmail(value: string): boolean {
		return value.includes('@') && value.includes('.');
	}
</script>

<DocsShell {settings}>
	<section class="flex flex-col gap-4">
		<DocsPreview>
			<svelte:fragment slot="bcu-previewer-preview">
				<InputChip
					bind:value={anythingList}
					name="chips-example"
					placeholder="Enter any value..."
					class="text-token"
				/>
			</svelte:fragment>
			<svelte:fragment slot="bcu-previewer-footer">
				<div class="text-center">
					<code>{anythingList.length ? anythingList.join(', ') : 'No chips available.'}</code>
				</div>
			</svelte:fragment>
			<svelte:fragment slot="bcu-previewer-source">
				<CodeBlock language="ts" code={`let list: string[] = ['foo', 'bar', 'fizz', 'buzz'];`} />
				<CodeBlock
					language="html"
					code={`<InputChip bind:value={list} name="chips" placeholder="Enter any value..." />`}
				/>
			</svelte:fragment>
		</DocsPreview>

		<section class="space-y-4">
			<p>
				Bind an array of data to the component <code>value</code> property. Only <u>string</u> values
				are supported at this time.
			</p>
		</section>
		<!-- Whitelist -->
		<section class="space-y-4">
			<h2>Whitelist Values</h2>
			<p>
				You can provide an array of strings to use as a whitelist. Only whitelisted items can be
				entered. Invalid or duplicate values will show an error state.
			</p>
			<DocsPreview background="neutral">
				<svelte:fragment slot="bcu-previewer-preview">
					<InputChip
						name="chips-example-flavors"
						bind:value={flavorsList}
						placeholder="Enter flavors..."
						chips="variant-filled-primary"
						whitelist={flavorsWhitelist}
					/>
				</svelte:fragment>
				<svelte:fragment slot="bcu-previewer-footer">
					<div class="text-center">
						<code>{flavorsList.length ? flavorsList.join(', ') : 'No flavors set.'}</code>
					</div>
				</svelte:fragment>
				<svelte:fragment slot="bcu-previewer-source">
					<CodeBlock
						language="ts"
						code={`let flavorsWhitelist = ['vanilla', 'chocolate', 'strawberry', 'peach', 'rocky road'];`}
					/>
					<CodeBlock language="html" code={`<InputChip ... whitelist={flavorsWhitelist} />`} />
				</svelte:fragment>
			</DocsPreview>
		</section>
		<!-- Custom Valiation -->
		<section class="space-y-4">
			<h2>Custom Validation</h2>
			<p>
				You can optionally provide a function to provide custom validation. Make sure to accept a
				string value and return a boolean.
			</p>
			<DocsPreview background="neutral">
				<svelte:fragment slot="bcu-previewer-preview">
					<InputChip
						name="chips-example-emails"
						bind:value={emails}
						placeholder="Enter Emails..."
						chips="variant-filled-secondary"
						validation={isValidEmail}
					/>
				</svelte:fragment>
				<svelte:fragment slot="bcu-previewer-footer">
					<div class="text-center">
						<code>{emails.length ? emails.join(', ') : 'No emails set.'}</code>
					</div>
				</svelte:fragment>
				<svelte:fragment slot="bcu-previewer-source">
					<CodeBlock
						language="ts"
						code={`function isValidEmail(value: string): boolean {\n\treturn value.includes('@') && value.includes('.');\n}`}
					/>
					<CodeBlock language="html" code={`<InputChip ... validation={isValidEmail} />`} />
				</svelte:fragment>
			</DocsPreview>
		</section>
		<!-- Additional Settings -->
		<section class="space-y-4">
			<h2>Additional Settings</h2>
			<p>Use the <code>max</code> property to define a maximum number of chips allowed.</p>
			<CodeBlock language="html" code={`<InputChip ... max={3} />`} />
			<p>
				Use the <code>minlength</code> and <code>maxlength</code> properties to set the minimum/maximum
				number of input characters respectively.
			</p>
			<CodeBlock language="html" code={`<InputChip ... minlength={2} maxlength={5} />`} />
			<p>
				By default, only a single instance of each value is allowed. If you wish to allow
				duplicates, set <code>allowDuplicates</code>.
			</p>
			<CodeBlock language="html" code={`<InputChip ... allowDuplicates />`} />
			<p>
				By default, all values are trimmed and formatted lowercase. If you wish to allow uppercase,
				set <code>allowUpperCase</code>.
			</p>
			<CodeBlock language="html" code={`<InputChip ... allowUpperCase />`} />
		</section>
		<hr />
		<!-- See Also -->
		<section
			class="!flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 md:space-x-4"
		>
			<div class="space-y-2">
				<h2>See Also</h2>
				<p>Interactive chip element styles for actions, selection, or filtering.</p>
			</div>
			<a class="btn variant-ghost-surface" href="/elements/chips">Chip Elements &rarr;</a>
		</section>
	</section>
</DocsShell>
